!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("leaflet"),require("georaster")):"function"==typeof define&&define.amd?define(["leaflet","georaster"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).GeoRasterLayer=e(t.L,t.parseGeoraster)}(this,(function(t,e){"use strict";return window.parseGeoraster=e,Object.freeze(Object.defineProperty({__proto__:null,default:e},Symbol.toStringTag,{value:"Module"})),t.GridLayer.extend({initialize:function(e,n){if(!e||!e.georaster)throw"georaster is required";t.setOptions(this,n);var r=this;e=e.georaster,e.then&&(e=await e),this.georaster=e,this.georasterLayerOptions=n,this.height=e.height,this.width=e.width,this.pixelHeight=e.pixelHeight,this.pixelWidth=e.pixelWidth,this.noDataValue=e.noDataValue,this.projection=e.projection,this.rasters=e.rasters,this.numberOfRasters=e.numberOfRasters,this.maxs=e.maxs,this.mins=e.mins,this.range=e.range,this.scale=e.scale,this.debugLevel=n.debugLevel||0,this.options.bounds=n.bounds||[[e.ymax,e.xmin],[e.ymin,e.xmax]],this.options.resolution=n.resolution||256},createTile:function(e,n){const r=document.createElement("canvas");r.width=r.height=this.options.resolution;const i=r.getContext("2d");let a=this.getBounds(),o=a.getSouthWest(),s=a.getNorthEast(),l=this.georaster,c=l.pixelWidth,f=l.pixelHeight,u=l.xmin,d=l.ymax,p=(s.lat-o.lat)/this.options.resolution,m=(s.lng-o.lng)/this.options.resolution;for(let t=0;t<this.options.resolution;t++)for(let e=0;e<this.options.resolution;e++){let a=s.lat-p*t-.5*p,o=o.lng+m*e+.5*m,h=Math.floor((d-a)/f),g=Math.floor((o-u)/c);if(h>=0&&g>=0&&h<this.height&&g<this.width){let a=this.rasters.map((t=>t[h][g]));this.noDataValue&&a.includes(this.noDataValue)||(a=this.scale?this.scale(...a):a[0],i.fillStyle=this.georasterLayerOptions.pixelValuesToColorFn(a),i.fillRect(e,t,1,1))}}return r}})}));

